<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-11-22 Sat 15:51 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Structured meshing in STAR-CCM+</title>
<meta name="author" content="jakub" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Structured meshing in STAR-CCM+</h1>
<p>
[<a href="../index.html">return</a>]
</p>
<div id="outline-container-orgae2c552" class="outline-2">
<h2 id="orgae2c552">The problem</h2>
<div class="outline-text-2" id="text-orgae2c552">
<p>
The RPI model implementation in STAR-CCM+ doesn't allow for the liquid temperature at a fixed y+ to be used as the liquid temperature. The consequence is that it is impossible to follow the usual mesh independence procedure, as the results are <a href="https://doi.org/10.1016/j.applthermaleng.2024.122678">the results are dependent on the thickness of the near-wall cell</a>. Mesh independence can only be shown for the bulk region, and therefore a structured meshing approach which allows the near-wall cell to remain the same size is needed. Commercial software is not generally well suited to structured meshing applications, and STAR-CCM+ is no exception. Using prism layers proves to be highly unreliable in this case, with their thicknesses varying sufficiently to disturb the calculation even with the utmost care on the part of the engineer. The real solution proves to be far more convoluted.
</p>
</div>
</div>
<div id="outline-container-org6392f5c" class="outline-2">
<h2 id="org6392f5c">The solution</h2>
<div class="outline-text-2" id="text-org6392f5c">
<p>
The following presents the meshing approach for a circular pipe using a 2D axisymmetric mesh. It assumes basic familiarity with STAR-CCM+ usage.
</p>

<ol class="org-ol">
<li>Create parts for the pipe and wall cell layer using an extrude.</li>
<li>Perform an imprint operation, selecting the CAD imprint option.</li>
<li>Perform a badge for 2D meshing operation.</li>
<li>Create a directed mesh operation, setting the source and target.</li>
<li>Create a quadrilateral automated mesh.</li>
<li>Set the base size of the mesh equal to the channel radius.</li>
<li>Set the target and minimum sizes at 100% relative to the base size.</li>
<li>Select user specified growth rate.</li>
<li>Create a custom volumetric control. Enable customise size on surface remesher, and set it to the wall cell layer thickness. Don't forget to select the input part.</li>
<li>Right click &gt; edit on the quadrilateral mesh, disable proximity and curvature refinement for good measure.</li>
<li>Control the radial cell count using the surface growth rate.</li>
</ol>

<p>
A basic Emacs lisp script example is provided below to obtain the required growth rate for a specified number of cells.
</p>

<div class="org-src-container">
<pre class="src src-elisp">  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">setq</span> radius 4e-3<span style="color: #ffffff;">)</span>
  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">setq</span> first-cell 0.00007649339528760109<span style="color: #ffffff;">)</span>
  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">setq</span> tol 1e-10<span style="color: #ffffff;">)</span>
  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">setq</span> cells 15<span style="color: #ffffff;">)</span>

  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">defun</span> <span style="color: #f78fe7;">fr</span> <span style="color: #ff66ff;">(</span>r<span style="color: #ff66ff;">)</span>
    <span style="color: #ff66ff;">(</span>-
     <span style="color: #00eff0;">(</span>* radius <span style="color: #ff6b55;">(</span>- 1 r<span style="color: #ff6b55;">)</span><span style="color: #00eff0;">)</span>
     <span style="color: #00eff0;">(</span>* first-cell
        <span style="color: #ff6b55;">(</span>- 1 <span style="color: #efef00;">(</span>expt r cells<span style="color: #efef00;">)</span><span style="color: #ff6b55;">)</span><span style="color: #00eff0;">)</span><span style="color: #ff66ff;">)</span><span style="color: #ffffff;">)</span>

  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">defun</span> <span style="color: #f78fe7;">frprime</span> <span style="color: #ff66ff;">(</span>r<span style="color: #ff66ff;">)</span>
    <span style="color: #ff66ff;">(</span>-
     <span style="color: #00eff0;">(</span>* first-cell cells <span style="color: #ff6b55;">(</span>expt r <span style="color: #efef00;">(</span>- cells 1<span style="color: #efef00;">)</span><span style="color: #ff6b55;">)</span><span style="color: #00eff0;">)</span>
     radius
     <span style="color: #ff66ff;">)</span><span style="color: #ffffff;">)</span>

  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">defun</span> <span style="color: #f78fe7;">newton-next</span> <span style="color: #ff66ff;">(</span>x fun deriv<span style="color: #ff66ff;">)</span>
    <span style="color: #ff66ff;">(</span>-
     x
     <span style="color: #00eff0;">(</span>/
      <span style="color: #ff6b55;">(</span>funcall fun x<span style="color: #ff6b55;">)</span>
      <span style="color: #ff6b55;">(</span>funcall deriv x<span style="color: #ff6b55;">)</span><span style="color: #00eff0;">)</span><span style="color: #ff66ff;">)</span><span style="color: #ffffff;">)</span>

  <span style="color: #ffffff;">(</span><span style="color: #79a8ff; font-weight: bold;">defun</span> <span style="color: #f78fe7;">newton-run</span> <span style="color: #ff66ff;">(</span>x fun deriv tolerance<span style="color: #ff66ff;">)</span>
      <span style="color: #ff66ff;">(</span><span style="color: #79a8ff; font-weight: bold;">while</span> <span style="color: #00eff0;">(</span>&gt; <span style="color: #ff6b55;">(</span>abs <span style="color: #efef00;">(</span>funcall fun x<span style="color: #efef00;">)</span><span style="color: #ff6b55;">)</span> tolerance<span style="color: #00eff0;">)</span>
        <span style="color: #00eff0;">(</span><span style="color: #79a8ff; font-weight: bold;">setq</span> x <span style="color: #ff6b55;">(</span>newton-next x fun deriv<span style="color: #ff6b55;">)</span><span style="color: #00eff0;">)</span><span style="color: #ff66ff;">)</span>
    x<span style="color: #ffffff;">)</span>

<span style="color: #ffffff;">(</span>newton-run 2 'fr 'frprime tol<span style="color: #ffffff;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: jakub</p>
<p class="date">Created: 2025-11-22 Sat 15:51</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
